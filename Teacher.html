<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/register.css">
    <!-- FontAwesome 4.7.0 CDN -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
        integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.css">
    <link rel="stylesheet" href="./javascript/jquery-ui-1.13.2.custom/jquery-ui.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css" />

    <style>
        .success-message {
            color: green
        }

        .error-message {
            color: red;
        }

        .required1::after {
            content: "*";
            color: red;
            font-size: 20px;
            margin: 5px;
        }

        @media only screen and (max-width: 576px) {
            .card {
                margin-top: 100px;
                max-height: fit-content;
                font-weight: bold;
            }


        }
    </style>
</head>

<body class="bg">
    <!--REGISTER HTML-->
    <div class="container mx-auto w-75 h-100">

        <form role="form" action="" method="post" class="registration-form my-2 mt-2 bg-white rounded">


            <div class="text-center">
                <p class=" h2 ">School Information</p>
            </div>
            <div class="row w-100 mx-auto">
                <div class=" col-lg-6 col-md-6 col-sm-12 w-lg-50 w-md-100 w-sm-100">
                    <label for="inputEmail4" class="form-label mx-2 required1">Teacher Name</label>
                    <input type="text" class="form-control " placeholder="Teacher name" aria-label="First name"
                   id="teacherName" name="teacherName">
                </div>
                <div class=" col-lg-6 col-md-6 col-sm-12 w-lg-50 w-md-100 w-sm-100">
                    <label for="inputEmail4" class="form-label mx-2 required1">School Name</label>
                    <input type="text" class="form-control " placeholder="School name" aria-label="First name"
                   id="schoolName" name="schoolName">
                </div>

            </div>
            <div class="row w-100 mx-auto">

                <div class="col-lg-6 col-md-6 col-sm-12 w-lg-50 w-md-100 w-sm-100">
                    <label for="inputEmail4" class="form-label mx-2 required1">City</label>
                    <input type="text" class="form-control" placeholder="City" aria-label="First name"
                      id="city" name="city">
                </div>
                <div class="col-lg-6 col-md-6 col-sm-12 w-lg-50 w-md-100 w-sm-100">
                    <label for="inputEmail4" class="form-label mx-2 required1">Pincode</label>
                   
                    <input type="tel" class="form-control w-100" aria-label="First name" placeholder="Pincode" id="pincode" name="pincode">
                    
                </div>

            </div>
            <div class="row w-100 mx-auto">

                <div class="col-lg-6 col-md-6 col-sm-12 w-lg-50 w-md-100 w-sm-100">
                    <label for="inputEmail4" class="form-label mx-2 required1">Email</label>
                    <input type="email" class="form-control" placeholder="Email" aria-label="email" id="email"
                        name="email">
                </div>
               
            

            </div>
           
            <div class="row w-100 mx-auto text-center">
                <div class="col-lg-12 col-md-12 col-sm-12 w-lg-50 w-md-100 w-sm-100 mt-2">
                    <label for="inputEmail4" class="form-label mx-2 required1">Whatsapp Number</label>
                    <input type="tel" id="whatsappNumber" name="whatsappNumber" class="form-control w-100" aria-label="First name" >
                    <a type="button" class="d-block  btn btn-next text-white w-50 mx-auto mt-2"
                        style="background-color: #e7260c ;" href="#" onclick="sendOTP()" id="sendotp">Send Otp</a>
                    <p id="otpStatus"></p>
                    <div class="d-none" id="verify">
                    <label for="inputEmail4" class="form-label mx-2  required1 ">Enter
                        OTP:</label>
                    <input type="numbers" id="otpInput" class="form-control mb-2 w-50 mx-auto" aria-label="First name">
                    <a type="button" class="btn btn-next w-50 text-white w-25 mx-auto mt-2 "
                        style="background-color: #32911a ;" href="#" onclick="verifyOTP1()">Verify Otp</a>

                    <div id="message"></div>
                    </div>
                </div>


            </div>
            <hr>
            <div class="row w-100 mx-auto text-center">
                <div class="col-lg-12 col-md-12 col-sm-12 w-lg-50 w-md-100 w-sm-100 mt-2">
                   <button id="excel" class="btn btn-md bg-danger text-white fw-bold disabled">Download File to fill student details </button>

                </div>


            </div>
<hr>
            <div class="row my-3 w-lg-50 w-md-100 w-sm-100">

                <a type="submit" class="btn btn-next text-white w-25 mx-auto disabled"
                    style="background-color: #087C94 ;" id="tsubmit">Submit</a>

            </div>


            
        </form>

    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="./javascript/jquery.backstretch.min.js"></script>

    <script src="./javascript/register.js"></script>
    <script src="./javascript/jquery-ui-1.13.2.custom/jquery-ui.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.8.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.8.0/firebase-auth.js"></script>
    
    <script src="sendotp.js"></script>
    <!-- Add intl-tel-input JS and utils JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
 <script type="text/javascript">
    // JavaScript code using Fetch API

 
function getIp(callback) {
  fetch('https://ipinfo.io/json?token=858ba90da1836c', { headers: { 'Accept': 'application/json' } })
    .then((resp) => resp.json())
    .catch(() => {
      return {
        country: 'in',
      };
    })
    .then((resp) => callback(resp.country));
}

const phoneInputField = document.querySelector("#whatsappNumber");
const phoneInput = window.intlTelInput(phoneInputField, {
  initialCountry: "IN",
  geoIpLookup: getIp,
  utilsScript:
    "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
});

const selectedCountryCode = phoneInput.getSelectedCountryData().dialCode;
console.log(selectedCountryCode); // Output: e.g., "+91" for India
const tsubmit = document.getElementById('tsubmit');
const excel = document.getElementById('excel');


tsubmit.addEventListener('click', function () {
  const selectedCountryCode = phoneInput.getSelectedCountryData().dialCode;
  console.log(selectedCountryCode); // Output: e.g., "+91" for India
  // Data to be sent in the POST request
  let teacherName = document.querySelector('#teacherName').value;
  let schoolname = document.querySelector('#schoolName').value;
  let email = document.querySelector('#email').value
  let pincode = document.querySelector('#pincode').value
  let city = document.querySelector('#city').value
  let whatsappNumber = selectedCountryCode+document.querySelector('#whatsappNumber').value
 
  const postData = {
    teacherName: teacherName,
    schoolName: schoolname,
    email: email,
    pinCode: pincode,
    city: city,
    phoneNumber: whatsappNumber
  };

  // Make a POST request using Fetch API
  fetch('http://localhost:8080/school/send', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(postData),
  })
    .then(response => response.json())
    .then(data => {
      console.log('Data sent successfully:', data);
      // Handle the response from the server if needed
    })
    .catch(error => {
      console.error('Error sending data:', error);
      // Handle any errors that occurred during the request
    });

});
document.getElementById('excel').addEventListener('click', function() {
            // Make a request to the backend API
            fetch('http://localhost:8080/school/downloadExcel', {
                method: 'GET',
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.blob(); // Extract the binary data (Excel file) from the response
            })
            .then(blobData => {
                // Create a URL for the blob data
                const url = window.URL.createObjectURL(blobData);

                // Create a temporary link element to download the Excel file
                const a = document.createElement('a');
                a.href = url;
                a.download = 'schoolData.xlsx'; // You can customize the filename here
                document.body.appendChild(a);
                a.click(); // Simulate a click on the link to trigger the download
                a.remove(); // Clean up the temporary link
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });

        const verify=document.getElementById('verify');
        sendotp.addEventListener('click', function() {
    // Check the current display state of the div
    const isHidden = verify.classList.contains('d-none');

    // Toggle the display state
    if (isHidden) {
        verify.classList.remove('d-none');
    } else {
        verify.classList.add('d-block');
    }
});
    </script>
</body>
</html>




